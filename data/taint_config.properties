###############################################
# VMDragonSlayer Dynamic Taint Tracking Config #
###############################################

# Tool paths - Override these in the UI if needed
# Default paths for common installations
pin.path.windows=C:/pin/pin.exe
pin.path.linux=/home/user/pin/pin
pin.path.mac=/Users/user/pin/pin

# Alternative analysis engines
triton.path.windows=C:/triton/triton.exe
triton.path.linux=/usr/local/bin/triton
intel_pt.enabled=false
bap.path=/usr/local/bin/bap

# Default trace directory - where handler traces will be stored
trace.directory=${user.home}/vmdragonslayer_traces
trace.max_size_mb=1024
trace.compression=true
trace.format=json

# Taint tracking configuration
taint.timeout=300
taint.granularity=BYTE
taint.propagation.flags=true
taint.propagation.memory=true
taint.propagation.registers=true
taint.propagation.stack=true
taint.propagation.heap=true

# Advanced taint options
taint.track_implicit_flows=true
taint.track_control_dependencies=false
taint.memory_tagging=shadow_memory
taint.precision=byte_level
taint.optimize_performance=true

# VM detection heuristics
vm.bytecode.min_size=64
vm.bytecode.max_size=16384
vm.dispatcher.loop_threshold=3
vm.dispatcher.min_tainted_reads=5
vm.handler.min_instructions=5
vm.handler.max_instructions=1000
vm.handler.clustering_threshold=0.8
vm.handler.similarity_metric=jaccard

# Advanced VM detection
vm.detect_nested_vms=true
vm.detect_polymorphic_handlers=true
vm.detect_handler_encryption=true
vm.context_switching_detection=true

# Analysis refinement
analysis.exclude_system_modules=true
analysis.ignore_library_code=true
analysis.follow_indirect_calls=true
analysis.max_call_depth=10
analysis.function_boundary_detection=true
analysis.dead_code_elimination=true

# Performance optimization
performance.parallel_analysis=true
performance.max_threads=4
performance.memory_limit_mb=4096
performance.cache_analysis_results=true
performance.cache_ttl_minutes=60

# Anti-analysis mitigation options
antianalysis.bypass_timing_checks=true
antianalysis.ignore_cpuid=true
antianalysis.hide_debugger=true
antianalysis.spoof_rdtsc=true
antianalysis.normalize_environment=true
antianalysis.disable_breakpoints=false
antianalysis.vm_detection_bypass=true

# Symbolic execution integration
symbolic.engine=triton
symbolic.timeout=60
symbolic.max_paths=16
symbolic.solver=z3
symbolic.unroll_loops=3
symbolic.path_pruning=true
symbolic.constraint_simplification=true
symbolic.memory_model=concrete_symbolic

# Machine learning integration
ml.enable_pattern_recognition=true
ml.confidence_threshold=0.75
ml.model_path=data/models/taint_classifier.pkl
ml.feature_extraction=ngram_opcodes
ml.real_time_classification=true

# Handler classification patterns
# Format: pattern.NAME=REGEX
pattern.vm_add=.*add|sum.*
pattern.vm_sub=.*sub|diff.*
pattern.vm_mul=.*mul|product.*
pattern.vm_div=.*div|quotient.*
pattern.vm_and=.*and|bitwise_and.*
pattern.vm_or=.*or|bitwise_or.*
pattern.vm_xor=.*xor|bitwise_xor.*
pattern.vm_not=.*not|bitwise_not.*
pattern.vm_shl=.*shl|shift_left.*
pattern.vm_shr=.*shr|shift_right.*
pattern.vm_load=.*load|read|fetch.*
pattern.vm_store=.*store|write|save.*
pattern.vm_push=.*push|stack_push.*
pattern.vm_pop=.*pop|stack_pop.*
pattern.vm_jmp=.*jmp|jump|goto.*
pattern.vm_jz=.*jz|jump_zero|branch_zero.*
pattern.vm_jnz=.*jnz|jump_not_zero|branch_not_zero.*
pattern.vm_call=.*call|invoke|execute.*
pattern.vm_ret=.*ret|return.*
pattern.vm_cmp=.*cmp|compare.*

# Output configuration
output.format=json
output.include_raw_traces=false
output.include_statistics=true
output.include_handler_graph=true
output.include_control_flow=true
output.detailed_taint_flows=true

# Logging configuration
logging.level=INFO
logging.file=logs/taint_tracking.log
logging.max_size_mb=100
logging.backup_count=5
logging.include_timestamps=true
logging.include_thread_id=true

# Report generation
report.auto_generate=true
report.format=html
report.include_visualizations=true
report.include_recommendations=true
report.template_path=templates/taint_report.html
pattern.vm_xor=.*xor.*
pattern.vm_mov=.*mov|load|store.*
pattern.vm_push=.*push|stack_add.*
pattern.vm_pop=.*pop|stack_remove.*
pattern.vm_jmp=.*jmp|branch|goto.*
pattern.vm_call=.*call|func.*
pattern.vm_ret=.*ret|return.*
pattern.vm_shl=.*shl|shift_left.*
pattern.vm_shr=.*shr|shift_right.*
pattern.vm_rol=.*rol|rotate_left.*
pattern.vm_ror=.*ror|rotate_right.*
pattern.vm_and=.*and|bitwise_and.*
pattern.vm_or=.*or|bitwise_or.*
pattern.vm_not=.*not|negate.*
pattern.vm_test=.*test|compare.*
pattern.vm_cmp=.*cmp|compare.*

# Logging configuration
log.level=INFO
log.file=${user.home}/vmdragonslayer_taint.log
log.max_size=10MB
log.backup_count=3

# Advanced options
advanced.use_native_pintool=true
advanced.cache_analyses=true
advanced.parallel_trace_analysis=true
advanced.max_threads=4
advanced.memory_limit=4096

# Developer options (usually should be false in production)
dev.debug_mode=false
dev.dump_instruction_traces=false
dev.profile_performance=false